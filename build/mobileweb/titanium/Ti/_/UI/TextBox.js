define(["Ti/_/declare","Ti/_/dom","Ti/_/event","Ti/_/style","Ti/_/lang","Ti/_/UI/FontWidget","Ti/UI"],function(e,t,i,o,a,n,r){var l=require.on,s=o.set;return e("Ti._.UI.TextBox",n,{constructor:function(){this._addEventModifier(["click","singletap","blur","change","focus","return"],function(e){e.value=this._getInternalText()})},_initTextBox:function(e){this._field=e;var t=null,o="";this._addStyleableDomNode(this._setFocusNode(e)),l(e,"keydown",this,function(t){return this.editable?(13===t.keyCode&&(this.suppressReturn&&(i.stop(t),e.blur()),this.fireEvent("return")),void 0):(i.stop(t),!1)}),l(e,"keypress",this,function(){setTimeout(a.hitch(this,function(){this._capitalize()}))}),l(e,"focus",this,function(){this.fireEvent("focus"),t=setInterval(a.hitch(this,function(){var t=e.value;(o.length!==t.length||o!==t)&&(this.fireEvent("change"),o=t)}),200)}),l(e,"blur",this,function(){clearInterval(t),this.fireEvent("blur")}),this.autocorrect=!0},_setInternalText:function(e){this._field.value!==e&&(this._field.value=e,this._capitalize())},_getInternalText:function(){return this._field.value},_updateInternalText:function(){this._setInternalText(this._getInternalText())},_capitalize:function(){var e="off",t=this._field;switch(this.autocapitalization){case r.TEXT_AUTOCAPITALIZATION_ALL:t.value=t.value.toUpperCase();break;case r.TEXT_AUTOCAPITALIZATION_SENTENCES:e="on"}this._field.autocapitalize=e},blur:function(){this._field.blur()},focus:function(){this._field.focus()},hasText:function(){return!!this._field.value},properties:{autocapitalization:{value:r.TEXT_AUTOCAPITALIZATION_SENTENCES,post:"_capitalize"},autocorrect:{post:function(e){this._field.autocorrect=e?"on":"off"}},editable:!0,maxLength:{set:function(e){return e=Math.max(0|e,0),t.attr[e>0?"set":"remove"](this._field,"maxlength",e),e}},returnKeyType:function(){return r.RETURNKEY_DEFAULT},suppressReturn:!0,textAlign:{post:function(e){s(this._field,"textAlign",/(center|right)/.test(e)?e:"left")}},value:{get:function(){return this._getInternalText()},post:"_setInternalText",value:""}}})});