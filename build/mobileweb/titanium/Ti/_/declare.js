define(["Ti/_","Ti/_/lang"],function(e,t){function i(e,t){for(var i,o,r,a,l,_,c,u,h=[],f=[{cls:0,refs:[]}],g={},p=1,y=e.length,v=0;y>v;++v){if(r=e[v],!r)throw Error('Unknown base class for "'+t+'" ['+v+"]");if(s(r,"Object"))r=e[v]=n(r);else if(!s(r,"Function"))throw Error('Base class not a function for "'+t+'" ['+v+"]");for(o=r._meta?r._meta.bases:[r],a=0,i=o.length-1;i>=0;--i)l=o[i].prototype,l.hasOwnProperty("declaredClass")||(l.declaredClass="uniqName_"+d++),c=l.declaredClass,g.hasOwnProperty(c)||(g[c]={count:0,refs:[],cls:o[i]},++p),_=g[c],a&&a!==_&&(_.refs.push(a),++a.count),a=_;++a.count,f[0].refs.push(a)}for(;f.length;){for(a=f.pop(),h.push(a.cls),--p;u=a.refs,1==u.length;){if(a=u[0],!a||--a.count){a=0;break}h.push(a.cls),--p}if(a)for(v=0,y=u.length;y>v;++v)a=u[v],--a.count||f.push(a)}if(p)throw Error("Can't build consistent linearization for \""+t+'"');return r=e[0],h[0]=r?r._meta&&r===h[h.length-r._meta.bases.length]?r._meta.bases.length:1:0,h}function o(e,i){return function(){var o,n,r,a,l=arguments,d=l,u=l[0],h=e.length,f=this.declaredClass;if(f&&(_[f]||(_[f]=0),this.widgetId=f+":"+_[f]++),i&&(u&&u.preamble||this.preamble))for(a=Array(e.length),a[0]=l,n=0;(u=l[0])&&(o=u.preamble)&&(l=o.apply(this,l)||l),o=e[n].prototype,o=o.hasOwnProperty("preamble")&&o.preamble,o&&(l=o.apply(this,l)||l),++n!==h;)a[n]=l;for(n=h-1;n>=0;--n)o=e[n],r=o._meta,r&&(o=r.ctor,t.mixProps(this,r.hidden)),s(o,"Function")&&o.apply(this,a?a[n]:l);if(s(u,"Object")){o=this.constants;for(n in u)u.hasOwnProperty(n)&&((o&&n in o?o.__values__:this)[n]=u[n])}this.toString===c.toString&&(this.toString=function(){return"[object "+(f?f.replace(/\./g,""):"Object")+"]"}),o=this.postscript,o&&o.apply(this,d)}}function n(e){var t=Function();return l(t.prototype,e),t._meta={bases:[t],hidden:e},t}function r(e,t){for(var i in t)t.hasOwnProperty(i)&&!/^(constructor|properties|constants|__values__)$/.test(i)&&(s(t[i],"Function")&&(t[i].nom=name),e[i]=t[i]);return e}function a(e,a,d){s(e,"String")||(d=a,a=e,e=""),d=d||{};var _,u,h,f=[d.constructor],g=1,p={},y=s(a);if("Array"===y?(f=i(a,e),a=f[g=f.length-f[0]]):"Function"===y?(h=a._meta,f=f.concat(h?h.bases:a)):"Object"===y?f[1]=a=n(a):a=0,a)for(u=g-1;_=Function(),_.prototype=a.prototype,p=new _,u;--u)h=f[u],(h._meta?r:l)(p,h.prototype),_=Function(),_.superclass=a,_.prototype=p,a=p.constructor=_;return r(p,d),h=d.constructor,h!==c.constructor&&(h.nom="constructor",p.constructor=h),l(f[0]=_=o(f,h),{_meta:{bases:f,hidden:d,ctor:d.constructor},superclass:a&&a.prototype,extend:function(e){return r(this.prototype,e),this},prototype:p}),l(p,{constructor:_,isInstanceOf:function(e){for(var t=this.constructor._meta.bases,i=0,o=t.length;o>i;++i)if(t[i]===e)return!0;return this instanceof e}}),e&&(p.declaredClass=e,t.setObject(e,_)),_}var s=require.is,l=require.mix,d=0,_={},c=Object.prototype;return e.declare=a});