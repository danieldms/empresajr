define(["Ti/_","Ti/_/lang"],function(e,t){function i(e,t){for(var i,o,n,r,s,_,c,u,h=[],f=[{cls:0,refs:[]}],y={},p=1,g=e.length,v=0;g>v;++v){if(n=e[v],!n)throw Error('Unknown base class for "'+t+'" ['+v+"]");if(l(n,"Object"))n=e[v]=a(n);else if(!l(n,"Function"))throw Error('Base class not a function for "'+t+'" ['+v+"]");for(o=n._meta?n._meta.bases:[n],r=0,i=o.length-1;i>=0;--i)s=o[i].prototype,s.hasOwnProperty("declaredClass")||(s.declaredClass="uniqName_"+d++),c=s.declaredClass,y.hasOwnProperty(c)||(y[c]={count:0,refs:[],cls:o[i]},++p),_=y[c],r&&r!==_&&(_.refs.push(r),++r.count),r=_;++r.count,f[0].refs.push(r)}for(;f.length;){for(r=f.pop(),h.push(r.cls),--p;u=r.refs,1==u.length;){if(r=u[0],!r||--r.count){r=0;break}h.push(r.cls),--p}if(r)for(v=0,g=u.length;g>v;++v)r=u[v],--r.count||f.push(r)}if(p)throw Error("Can't build consistent linearization for \""+t+'"');return n=e[0],h[0]=n?n._meta&&n===h[h.length-n._meta.bases.length]?n._meta.bases.length:1:0,h}function o(e,i){return function(){var o,a,n,r,s=arguments,d=s,u=s[0],h=e.length,f=this.declaredClass;if(f&&(_[f]||(_[f]=0),this.widgetId=f+":"+_[f]++),i&&(u&&u.preamble||this.preamble))for(r=Array(e.length),r[0]=s,a=0;(u=s[0])&&(o=u.preamble)&&(s=o.apply(this,s)||s),o=e[a].prototype,o=o.hasOwnProperty("preamble")&&o.preamble,o&&(s=o.apply(this,s)||s),++a!==h;)r[a]=s;for(a=h-1;a>=0;--a)o=e[a],n=o._meta,n&&(o=n.ctor,t.mixProps(this,n.hidden)),l(o,"Function")&&o.apply(this,r?r[a]:s);if(l(u,"Object")){o=this.constants;for(a in u)u.hasOwnProperty(a)&&((o&&a in o?o.__values__:this)[a]=u[a])}this.toString===c.toString&&(this.toString=function(){return"[object "+(f?f.replace(/\./g,""):"Object")+"]"}),o=this.postscript,o&&o.apply(this,d)}}function a(e){var t=Function();return s(t.prototype,e),t._meta={bases:[t],hidden:e},t}function n(e,t){for(var i in t)t.hasOwnProperty(i)&&!/^(constructor|properties|constants|__values__)$/.test(i)&&(l(t[i],"Function")&&(t[i].nom=name),e[i]=t[i]);return e}function r(e,r,d){l(e,"String")||(d=r,r=e,e=""),d=d||{};var _,u,h,f=[d.constructor],y=1,p={},g=l(r);if("Array"===g?(f=i(r,e),r=f[y=f.length-f[0]]):"Function"===g?(h=r._meta,f=f.concat(h?h.bases:r)):"Object"===g?f[1]=r=a(r):r=0,r)for(u=y-1;_=Function(),_.prototype=r.prototype,p=new _,u;--u)h=f[u],(h._meta?n:s)(p,h.prototype),_=Function(),_.superclass=r,_.prototype=p,r=p.constructor=_;return n(p,d),h=d.constructor,h!==c.constructor&&(h.nom="constructor",p.constructor=h),s(f[0]=_=o(f,h),{_meta:{bases:f,hidden:d,ctor:d.constructor},superclass:r&&r.prototype,extend:function(e){return n(this.prototype,e),this},prototype:p}),s(p,{constructor:_,isInstanceOf:function(e){for(var t=this.constructor._meta.bases,i=0,o=t.length;o>i;++i)if(t[i]===e)return!0;return this instanceof e}}),e&&(p.declaredClass=e,t.setObject(e,_)),_}var l=require.is,s=require.mix,d=0,_={},c=Object.prototype;return e.declare=r});