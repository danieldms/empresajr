define(function(){var e={},t=[];return{dynamic:!0,normalize:function(e,t){var i=e.split("!"),o=i[0];return i.shift(),(/^\./.test(o)?t(o):o)+(i.length?"!"+i.join("!"):"")},load:function(i,o,n){var a,r,s,l,d=i.split("!"),_=d.length;if((l=_>1&&"sandbox"===d[0])&&(d.shift(),i=d.join("!")),s=o.toUrl(/^\//.test(i)?i:"./"+i,t.length?{name:t[t.length-1]}:null),a=e[s]||o.cache(s),!a){if(r=new XMLHttpRequest,r.open("GET",s,!1),r.send(null),200!==r.status)throw Error('Failed to load include "'+s+'": '+r.status);a=r.responseText}t.push(s);try{o.evaluate(e[s]=a,0,!l)}catch(c){throw c}finally{t.pop()}n(a)}}});