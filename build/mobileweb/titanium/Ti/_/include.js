define(function(){var e={},t=[];return{dynamic:!0,normalize:function(e,t){var i=e.split("!"),o=i[0];return i.shift(),(/^\./.test(o)?t(o):o)+(i.length?"!"+i.join("!"):"")},load:function(i,o,n){var a,r,l,s,d=i.split("!"),_=d.length;if((s=_>1&&"sandbox"===d[0])&&(d.shift(),i=d.join("!")),l=o.toUrl(/^\//.test(i)?i:"./"+i,t.length?{name:t[t.length-1]}:null),a=e[l]||o.cache(l),!a){if(r=new XMLHttpRequest,r.open("GET",l,!1),r.send(null),200!==r.status)throw Error('Failed to load include "'+l+'": '+r.status);a=r.responseText}t.push(l);try{o.evaluate(e[l]=a,0,!s)}catch(c){throw c}finally{t.pop()}n(a)}}});