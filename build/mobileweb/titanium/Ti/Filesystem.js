define(["Ti/_","Ti/_/Evented","Ti/_/lang","Ti/Filesystem/File"],function(e,t,i,o){function a(){var e,t=/(.+:\/\/)?(.*)/,o="",a=[],r=i.toArray(arguments).filter(function(e){return void 0!==e}).map(function(e){return o||(o=e.match(t))&&(o=o[1]||""),e.replace(o,"").replace(/^\/|\/$/g,"")}).join("/");return r.split("/").forEach(function(t){if(".."===t&&".."!==e){if(!a.length)throw Error('Irrational path "'+r+'"');a.pop(),e=a[a.length-1]}else t&&"."!==t&&a.push(e=t)}),r=o+a.join("/"),o||/^\//.test(r)||(r="/"+r),r}function r(t){var i=new o({_type:t.charAt(0),nativePath:n+e.uuid()});return i["create"+t]()?i:null}var l="appdata://",n="tmp://";return i.setObject("Ti.Filesystem",t,{constants:{MODE_APPEND:4,MODE_READ:1,MODE_WRITE:2,applicationDataDirectory:l,lineEnding:"\n",resourcesDirectory:"/",separator:"/",tempDirectory:n},protocols:["appdata","tmp"],createTempDirectory:function(){return r("Directory")},createTempFile:function(){return r("File")},getFile:function(){return new o(a.apply(null,arguments))},isExternalStoragePresent:function(){return!1},openStream:function(e){var t,r=i.toArray(arguments);return r.shift(),t=new o(a.apply(null,r)),t.open(e)}})});